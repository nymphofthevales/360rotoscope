<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Rock Paper Scissors</title>
    <style>
        * {
            font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
        }
        button {
            padding: 10px;
            font-size: 1.8vh;
            background-color: white;
            border: 1px solid #777777;
            border-radius: 5px;
        }
        button:hover {
            background-color: #aaaaaa;
        }
        button:active {
            background-color: #555555;
        }
        .hidden {
            display: none;
        }
        #illusion-bg {
            background-color: beige;
            position: absolute;
            left: 0;
            top: 0;
            height: 100vh;
            width: 100vw;
        }
        #choice-illusion {
            color: darkred;
        }
        #game-frame {
            padding: 0 0 0 100px;
            height:50vh;
            min-height: 200px;
            width: 60vw;
            min-width: 500px;
            overflow-y: scroll;
            overflow-x: hidden;
            background-color: #aabbaa;
        }
        #game-frame {
            border-left: 10px solid black;
        }
        #blackscreen {
            background-color: #000000;
        }
        .center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
    </style>
</head>
<body>
    <main id="game-frame" class="center">
        <header>
            <h1>Rock-Paper-Scissors Simulator</h1>
        </header>
        <p>This is a rock paper scissors algorithm. It's going to put out paper first.</p>
            <button id="rock">Rock</button>
            <button id="paper">Paper</button>
            <button id="scissors">Scissors</button>
            <div id="output"></div>
            <button id="play-again" class="hidden">Play Again</button>
    </main>
    <div id="illusion-bg"  class="hidden">
        <h1 id="choice-illusion" class="center">CHOICE IS AN ILLUSION</h1>
    </div>
    <div id="countdown">
        <p id="countdown-number"></p>
     </div>
     <div id="blackscreen">
     </div>
    <script>
        let roundnumber = 1;
        let choices = ['rock', 'paper', 'scissors']
        let gamelogic = {
            "rock": {
                "beats": "scissors",
                "loses": "paper"
            },
            "paper": {
                "beats": "rock",
                "loses": "scissors"
            },
            "scissors": {
                "beats": "paper",
                "loses": "rock"
            }
        }
        class Button {
            HTMLElement;
            messageOnClick;
            constructor(id) {
                this.HTMLElement = document.getElementById(id);
            }
            hide = () => { this.HTMLElement.classList.add('hidden') }
            show = (string) => { 
                this.HTMLElement.classList.remove('hidden');
                this.messageOnClick = string;
             }
            setText = (text) => { this.HTMLElement.innerText = text }
        }
        let output = document.getElementById('output')
        let playAgain = new Button('play-again')
        let rock = new Button('rock')
        let paper = new Button('paper')
        let scissors = new Button('scissors')
        rock.HTMLElement.addEventListener('click',()=>{
            removeButtons();
            play('rock')
        })
        paper.HTMLElement.addEventListener('click',()=>{
            removeButtons();
            play('paper')
        })
        scissors.HTMLElement.addEventListener('click',()=>{
            removeButtons();
            play('scissors')
        })
        playAgain.HTMLElement.addEventListener('click',()=>{
            playAgain.hide();
            roundnumber++
            output.innerHTML+= `<h3>Round ${roundnumber}:</h3>`
            setTimeout(()=>{
                createButtons(playAgain.messageOnClick)
            }, 500)
        })



        function play(choice) {
            

            switch (roundnumber) {
                case 1: round1(choice)
                    break;
                case 2: round2(choice)
                    break;
                case 3: round3(choice)
                    break;
                case 4: round4(choice)
                    break;
                case 5: round5(choice)
                    break;
            }
        }
        function round1(choice) {
            output.innerHTML = "<h3>Round 1:</h3>"
            let computerChoice = getRandWin(choice);
            output.innerHTML += `<p>You played: ${choice}.</p>`
            
            setTimeout(()=>{
                output.innerHTML += `<p>I choose: ${computerChoice}!</p>`
                setTimeout(()=>{
                    output.innerHTML += `<p>I win. ;)</p>`
                    setTimeout(()=>{
                        playAgain.show("<p>Predictable. It will throw scissors now.</p>")
                    },1000)
                },500)
            },1000)
        }
        function round2(choice) { 
            let computerChoice = getRandWin(choice);
            output.innerHTML += `<p>Foolishly, you played: ${choice}.</p>`
            setTimeout(()=>{
                output.innerHTML += `<p>Naturally, I choose: ${computerChoice}!</p>`
                setTimeout(()=>{
                    output.innerHTML += `<p>I win again. ;)</p>`
                    setTimeout(()=>{
                        playAgain.show("<p>Try again. It will throw rock.</p>")
                    },1000)
                },500)
            },1000)

        }
        function round3(choice) {
            let computerChoice = getRandWin(choice);
            output.innerHTML += `<p>This time you played: ${choice}.</p>`
            setTimeout(()=>{
                output.innerHTML += `<p>But I had predicted this and chose...!</p>`
                setTimeout(()=>{
                    output.innerHTML += `<p>...</p>`
                    setTimeout(()=>{
                        output.innerHTML += `<p>${computerChoice}</p>`
                        setTimeout(()=>{
                            playAgain.show("<p>Try again. It will throw rock.</p>")
                        },1000)
                    }, 500)
               },500)
            },1000)
        }
        function round4(choice) {

        }
        function round5(choice) {

        }
        function round6(choice) {

        }
        function getRandWin(choice) {
            let notDone = true
            let computerChoice;
            while (notDone) {
                computerChoice = choices[Math.floor(Math.random()*3)]
                if (gamelogic[computerChoice].beats == choice) {
                    notDone = false;
                }
            }
            return computerChoice;
        }
        function getRandLoss(choice) {
            let notDone = true
            let computerChoice;
            while (notDone) {
                computerChoice = choices[Math.floor(Math.random()*2)]
                if (gamelogic[computerChoice].loses == choice) {
                    notDone = false;
                }
            }
            return computerChoice;
        }

        function createButtons(string) {
            if(string != undefined) {
               output.innerHTML += string;
            }
            setTimeout(()=>{
                const butt = document.createElement("button");
                const node = document.createTextNode("Rock");
                butt.appendChild(node);
                output.appendChild(butt).id = "rock";

                const butt2 = document.createElement("button");
                const node2 = document.createTextNode("Paper");
                butt2.appendChild(node2);
                output.appendChild(butt2).id = "paper";

                const butt3 = document.createElement("button");
                const node3 = document.createTextNode("Scissors");
                butt3.appendChild(node3);
                output.appendChild(butt3).id = "scissors";

                document.getElementById('rock').addEventListener('click',()=>{
                    removeButtons();
                    play('rock')
                })
                document.getElementById('paper').addEventListener('click',()=>{
                    removeButtons();
                    play('paper')
                })
                document.getElementById('scissors').addEventListener('click',()=>{
                    removeButtons();
                    play('scissors')
                })
            }, 500)
        
        }

        function removeButtons() {

            let elem = document.getElementById("rock");
            elem.parentNode.removeChild(elem);

             elem = document.getElementById("paper");
            elem.parentNode.removeChild(elem);

             elem = document.getElementById("scissors");
            elem.parentNode.removeChild(elem);
        }
        /*function print(string) {
             let charsArray = string.split('');
            function loop(i) {
                setTimeout(()=>{
                    output.innerText= `${output.textContent}` + `${charsArray[i]}`;
                    if (output.innerText.length < charsArray.length) {
                        stillPrinting = true;
                        loop(i+1);
                    } else {
                        stillPrinting = false;
                        return;
                    }
                },50)
            }
            loop(0);
            return true
        }*/
    </script>
</body>
</html>